# Настройка клавиатуры и локализации. LFS.

Собрал LFS. Установил её на старый ноут Asus K50IJ. Жалко выкидывать разбитый полуживой ноут, но и не хочу, чтобы пылился без дела. Поэтому использую его как печатную машинку. Кстати, эту заметку писал именно на этом ноуте.

![keyboard](png1.jpg "Linux Keyboard")

Для того, чтобы достичь поставленной цели (использовать ноут как печатную машинку), нужно правильно настроить систему. И это LFS, а не какой-то Debian, поэтому нет псевдографических настройщиков типа dpkg-reconfigure. Более того, я долго и упорно, как упрямый осёл, редактировал конфиги `/etc/default/console-setup` и `/etc/default/keyboard-configuration`, как это делал на других дистрибутивах и всё работало. Но здесь же - нет. В LFS привычное расположение нужных конфигов, а не как в дебианах и федорах всяких.

## Настройка локализации
Для начала нужно настроить локализацию системы и шрифт, дабы кириллица отображалась корректно.
Ввести в консоли:
```
cat > /etc/sysconfig/console << "EOF"
# Begin /etc/sysconfig/console

UNICODE="1"
KEYMAP="ru"
FONT="cyr-sun16"

# End /etc/sysconfig/console
EOF
```

### Объяснение переменных
* `UNICODE="1"` - при значении `1`, `yes` или `true` консоль переводится в режим `UTF-8`. Для русского языка в самый раз.
* `KEYMAP="ru"` - переменная определяет аргументы для программы `loadkeys`. Значение - имя загружаемой раскладки клавиатуры, в нашем случае - `ru`.
* `FONT="cyr-sun16"` - переменная определяет аргументы для программы `setfont`. Значение - имя шрифта. Для того, чтобы просмотреть список установленных шрифтов, выполните:
```
ls /usr/share/consolefonts
```

## Шрифты, язык, кодировка.
Шрифт. Для начала вывести текущий:
```
showconsolefont
```

Все шрифты хранятся в директории `/usr/share/consolefonts`. Выполнить:
```
ls /usr/share/consolefonts
```
, чтобы просмотреть установленные шрифты. Я советую использовать `cyr-sun16`. Кстати, в конфиге выше этот шрифт уже прописан. "Насильно". Ну а так, для справки, выполнить:
```
setfont /путь/до/шрифта
```
Чтобы заменить его. Хотя в данном случае этого не требуется, так как всё уже прописано в конфиге `/etc/sysconfig/console`.

И настройка кодировки и языка. Первым делом нужно вывести список всех доступных сгенерированных локалей, чтобы убедиться, что нужная локаль присутствует в системе:
```
locale -a |grep 'ЛОКАЛЬ'
```
`ЛОКАЛЬ` замените на нужную локализацию. Если вы хотите просмотреть список всех доступных локализаций, выполните:
```
locale -a
```

Для того, чтобы просмотреть текущую установленную локализацию, выполните:
```
locale
```

Для того, чтобы "руссифицировать" консоль, нужно дать переменной $LC_ALL нужное значение, в нашем случае, `ru_RU.UTF-8`:
```
export LC_ALL="ru_RU.UTF-8"
```

Переменная LC_ALL переопределяет своим значением все переменные LC-* (это хорошо видно, выполнив `locale`), включая $LANG.

Ну и на всякий случай:
```
export LANG="ru_RU.UTF-8"
```
Для того, чтобы настройки не сбрасывались после завершения сессии, запишите две последние команды в `~/.bashrc`.


## Смотрите так же:
* файлы `/etc/sysconfig/console`, `/etc/sysconfig/keyboard`
* `man locale`
* `man localedef`
* `man setfont`
